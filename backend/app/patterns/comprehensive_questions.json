{
  "metadata": {
    "total_questions": 100,
    "created_date": "2024-12-XX",
    "description": "Comprehensive HR Analytics Questions Dataset - All 7 Tables Coverage",
    "coverage": {
      "employee_master": 30,
      "compensation_history": 15,
      "engagement_surveys": 12,
      "headcount_attrition_summary": 15,
      "performance_reviews": 12,
      "skills_inventory": 8,
      "training_records": 8
    },
    "query_types": {
      "single_table": 40,
      "two_table_join": 35,
      "three_table_join": 15,
      "aggregation": 45,
      "time_series": 20,
      "ranking": 15,
      "distribution": 10,
      "comparison": 10
    }
  },
  "questions": [
    {
      "id": 1,
      "question": "Show me department wise headcount",
      "category": "easy",
      "pattern_type": "headcount_by_department",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", COUNT(*) AS headcount FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Department\" ORDER BY headcount DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "headcount"
    },
    {
      "id": 2,
      "question": "What is the gender distribution of employees?",
      "category": "easy",
      "pattern_type": "distribution",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Gender\", COUNT(*) AS count FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Gender\"",
      "visualization": "pie",
      "x_axis": "Gender",
      "y_axis": "count"
    },
    {
      "id": 3,
      "question": "Show me headcount trends over time by month",
      "category": "easy",
      "pattern_type": "time_series_trend",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"MonthEnd\", SUM(\"Headcount\") AS Total_Headcount FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "Total_Headcount"
    },
    {
      "id": 4,
      "question": "Give me Top 3 Employees with highest salary",
      "category": "easy",
      "pattern_type": "top_n_ranking",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"Salary\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL ORDER BY \"Salary\" DESC LIMIT 3",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "Salary",
      "parameters": {"n": 3, "order": "DESC", "field": "Salary"}
    },
    {
      "id": 5,
      "question": "Show me top 5 highest paid employees",
      "category": "easy",
      "pattern_type": "top_n_ranking",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"Salary\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL ORDER BY \"Salary\" DESC LIMIT 5",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "Salary",
      "parameters": {"n": 5, "order": "DESC", "field": "Salary"}
    },
    {
      "id": 6,
      "question": "What is the average salary by department?",
      "category": "easy",
      "pattern_type": "aggregation_by_group",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", ROUND(AVG(\"Salary\"), 2) AS avg_salary FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL GROUP BY \"Department\" ORDER BY avg_salary DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_salary"
    },
    {
      "id": 7,
      "question": "Show me monthly attrition rate trends",
      "category": "medium",
      "pattern_type": "time_series_trend",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"MonthEnd\", AVG(\"AttritionRate\") AS avg_attrition_rate FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "avg_attrition_rate"
    },
    {
      "id": 8,
      "question": "What is the total number of active employees?",
      "category": "easy",
      "pattern_type": "single_value_count",
      "tables": ["employees.employee_master"],
      "sql": "SELECT COUNT(*) AS total_employees FROM employees.employee_master WHERE \"Status\" = 'Active'",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 9,
      "question": "Show me employees by job title",
      "category": "easy",
      "pattern_type": "group_by_category",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"JobTitle\", COUNT(*) AS count FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"JobTitle\" ORDER BY count DESC",
      "visualization": "bar",
      "x_axis": "JobTitle",
      "y_axis": "count"
    },
    {
      "id": 10,
      "question": "What is the average performance rating by department?",
      "category": "medium",
      "pattern_type": "aggregation_by_group",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", ROUND(AVG(\"PerformanceRating\"), 2) AS avg_rating FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"PerformanceRating\" IS NOT NULL GROUP BY \"Department\" ORDER BY avg_rating DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_rating"
    },
    {
      "id": 11,
      "question": "Show me salary changes over time for a specific employee",
      "category": "medium",
      "pattern_type": "time_series_join",
      "tables": ["employees.employee_master", "employees.compensation_history"],
      "sql": "SELECT ch.\"ChangeDate\", ch.\"OldSalary\", ch.\"NewSalary\", ch.\"Reason\", em.\"FullName\" FROM employees.compensation_history ch JOIN employees.employee_master em ON ch.\"EmployeeID\" = em.\"EmployeeID\" WHERE em.\"EmployeeID\" = 'PNR-1001' ORDER BY ch.\"ChangeDate\"",
      "visualization": "line",
      "x_axis": "ChangeDate",
      "y_axis": "NewSalary"
    },
    {
      "id": 12,
      "question": "What is the average salary increase percentage?",
      "category": "medium",
      "pattern_type": "calculated_metric",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT ROUND(AVG(((ch.\"NewSalary\" - ch.\"OldSalary\") / NULLIF(ch.\"OldSalary\", 0)) * 100), 2) AS avg_increase_percent FROM employees.compensation_history ch WHERE ch.\"OldSalary\" IS NOT NULL AND ch.\"NewSalary\" IS NOT NULL",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 13,
      "question": "Show me employees with highest engagement scores",
      "category": "medium",
      "pattern_type": "top_n_join",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", AVG(es.\"OverallSatisfaction\") AS avg_satisfaction FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY avg_satisfaction DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "avg_satisfaction"
    },
    {
      "id": 14,
      "question": "What is the average work-life balance score by department?",
      "category": "medium",
      "pattern_type": "aggregation_join",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(es.\"WorkLifeBalanceScore\"), 2) AS avg_worklife_score FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_worklife_score DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_worklife_score"
    },
    {
      "id": 15,
      "question": "Show me monthly hiring trends",
      "category": "easy",
      "pattern_type": "time_series_trend",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"MonthEnd\", SUM(\"Hires\") AS total_hires FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "total_hires"
    },
    {
      "id": 16,
      "question": "What is the department with highest attrition rate?",
      "category": "medium",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"Department\", AVG(\"AttritionRate\") AS avg_attrition FROM employees.headcount_attrition_summary GROUP BY \"Department\" ORDER BY avg_attrition DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_attrition"
    },
    {
      "id": 17,
      "question": "Show me employees with their performance review scores",
      "category": "medium",
      "pattern_type": "join_display",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", pr.\"ReviewDate\", pr.\"OverallScore\", pr.\"Communication\", pr.\"Teamwork\", pr.\"ProblemSolving\" FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' ORDER BY pr.\"ReviewDate\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 18,
      "question": "What is the average performance score by department?",
      "category": "medium",
      "pattern_type": "aggregation_join",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_performance DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_performance"
    },
    {
      "id": 19,
      "question": "Show me employees with most skills",
      "category": "medium",
      "pattern_type": "top_n_join",
      "tables": ["employees.employee_master", "employees.skills_inventory"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(si.\"SkillID\") AS skill_count FROM employees.employee_master em LEFT JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY skill_count DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "skill_count"
    },
    {
      "id": 20,
      "question": "What skills are most common in the organization?",
      "category": "easy",
      "pattern_type": "group_by_category",
      "tables": ["employees.skills_inventory"],
      "sql": "SELECT \"SkillName\", COUNT(*) AS count FROM employees.skills_inventory GROUP BY \"SkillName\" ORDER BY count DESC",
      "visualization": "bar",
      "x_axis": "SkillName",
      "y_axis": "count"
    },
    {
      "id": 21,
      "question": "Show me training completion rates by department",
      "category": "medium",
      "pattern_type": "aggregation_join",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"Department\", COUNT(CASE WHEN tr.\"Status\" = 'Completed' THEN 1 END) * 100.0 / COUNT(tr.\"TrainingID\") AS completion_rate FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\"",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "completion_rate"
    },
    {
      "id": 22,
      "question": "What is the total number of training courses completed?",
      "category": "easy",
      "pattern_type": "single_value_count",
      "tables": ["employees.training_records"],
      "sql": "SELECT COUNT(*) AS total_completed FROM employees.training_records WHERE \"Status\" = 'Completed'",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 23,
      "question": "Show me employees hired in the last year",
      "category": "easy",
      "pattern_type": "date_filter",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"HireDate\" FROM employees.employee_master WHERE \"HireDate\" >= CURRENT_DATE - INTERVAL '1 year' AND \"Status\" = 'Active' ORDER BY \"HireDate\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 24,
      "question": "What is the average tenure of employees by department?",
      "category": "medium",
      "pattern_type": "calculated_metric",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", ROUND(AVG(EXTRACT(EPOCH FROM (CURRENT_DATE - \"HireDate\")) / 365.25), 2) AS avg_tenure_years FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"HireDate\" IS NOT NULL GROUP BY \"Department\" ORDER BY avg_tenure_years DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_tenure_years"
    },
    {
      "id": 25,
      "question": "Show me top 10 employees with highest performance ratings",
      "category": "easy",
      "pattern_type": "top_n_ranking",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"PerformanceRating\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"PerformanceRating\" IS NOT NULL ORDER BY \"PerformanceRating\" DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "PerformanceRating",
      "parameters": {"n": 10, "order": "DESC", "field": "PerformanceRating"}
    },
    {
      "id": 26,
      "question": "What is the salary distribution by gender?",
      "category": "medium",
      "pattern_type": "distribution",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Gender\", COUNT(*) AS count, ROUND(AVG(\"Salary\"), 2) AS avg_salary FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL GROUP BY \"Gender\"",
      "visualization": "bar",
      "x_axis": "Gender",
      "y_axis": "avg_salary"
    },
    {
      "id": 27,
      "question": "Show me monthly termination trends",
      "category": "medium",
      "pattern_type": "time_series_trend",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"MonthEnd\", SUM(\"Terminations\") AS total_terminations FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "total_terminations"
    },
    {
      "id": 28,
      "question": "What is the average manager feedback score?",
      "category": "easy",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.engagement_surveys"],
      "sql": "SELECT ROUND(AVG(\"ManagerFeedbackScore\"), 2) AS avg_manager_feedback FROM employees.engagement_surveys WHERE \"ManagerFeedbackScore\" IS NOT NULL",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 29,
      "question": "Show me employees with salary above average",
      "category": "medium",
      "pattern_type": "filter_above_average",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"Salary\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" > (SELECT AVG(\"Salary\") FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL) ORDER BY \"Salary\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 30,
      "question": "What is the total compensation change amount this year?",
      "category": "medium",
      "pattern_type": "date_filtered_aggregation",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT SUM(\"NewSalary\" - \"OldSalary\") AS total_change FROM employees.compensation_history WHERE EXTRACT(YEAR FROM \"ChangeDate\") = EXTRACT(YEAR FROM CURRENT_DATE)",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 31,
      "question": "Show me department headcount over time",
      "category": "medium",
      "pattern_type": "time_series_grouped",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"MonthEnd\", \"Department\", SUM(\"Headcount\") AS headcount FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\", \"Department\" ORDER BY \"MonthEnd\", \"Department\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "headcount"
    },
    {
      "id": 32,
      "question": "What is the employee count by status?",
      "category": "easy",
      "pattern_type": "group_by_category",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Status\", COUNT(*) AS count FROM employees.employee_master GROUP BY \"Status\"",
      "visualization": "pie",
      "x_axis": "Status",
      "y_axis": "count"
    },
    {
      "id": 33,
      "question": "Show me employees with their latest performance review",
      "category": "medium",
      "pattern_type": "latest_record_join",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT DISTINCT ON (em.\"EmployeeID\") em.\"FullName\", em.\"Department\", pr.\"ReviewDate\", pr.\"OverallScore\" FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' ORDER BY em.\"EmployeeID\", pr.\"ReviewDate\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 34,
      "question": "What is the average training score by course?",
      "category": "medium",
      "pattern_type": "aggregation_by_group",
      "tables": ["employees.training_records"],
      "sql": "SELECT \"CourseName\", ROUND(AVG(\"Score\"), 2) AS avg_score FROM employees.training_records WHERE \"Status\" = 'Completed' AND \"Score\" IS NOT NULL GROUP BY \"CourseName\" ORDER BY avg_score DESC",
      "visualization": "bar",
      "x_axis": "CourseName",
      "y_axis": "avg_score"
    },
    {
      "id": 35,
      "question": "Show me skill proficiency distribution",
      "category": "medium",
      "pattern_type": "distribution",
      "tables": ["employees.skills_inventory"],
      "sql": "SELECT \"ProficiencyLevel\", COUNT(*) AS count FROM employees.skills_inventory GROUP BY \"ProficiencyLevel\"",
      "visualization": "pie",
      "x_axis": "ProficiencyLevel",
      "y_axis": "count"
    },
    {
      "id": 36,
      "question": "What is the total headcount change this month?",
      "category": "medium",
      "pattern_type": "monthly_comparison",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT SUM(\"Headcount\") - LAG(SUM(\"Headcount\")) OVER (ORDER BY \"MonthEnd\") AS headcount_change FROM employees.headcount_attrition_summary WHERE \"MonthEnd\" >= CURRENT_DATE - INTERVAL '2 months' GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\" DESC LIMIT 1",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 37,
      "question": "Show me employees with multiple performance reviews",
      "category": "medium",
      "pattern_type": "having_clause",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(pr.\"ReviewID\") AS review_count FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" HAVING COUNT(pr.\"ReviewID\") > 1 ORDER BY review_count DESC",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "review_count"
    },
    {
      "id": 38,
      "question": "What is the correlation between engagement and performance?",
      "category": "tricky",
      "pattern_type": "correlation_analysis",
      "tables": ["employees.employee_master", "employees.engagement_surveys", "employees.performance_reviews"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement, ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\"",
      "visualization": "scatter",
      "x_axis": "avg_engagement",
      "y_axis": "avg_performance"
    },
    {
      "id": 39,
      "question": "Show me top 5 departments by average salary",
      "category": "easy",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", ROUND(AVG(\"Salary\"), 2) AS avg_salary FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL GROUP BY \"Department\" ORDER BY avg_salary DESC LIMIT 5",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_salary",
      "parameters": {"n": 5, "order": "DESC", "field": "avg_salary"}
    },
    {
      "id": 40,
      "question": "What is the employee turnover rate?",
      "category": "medium",
      "pattern_type": "calculated_metric",
      "tables": ["employees.employee_master"],
      "sql": "SELECT COUNT(CASE WHEN \"Status\" = 'Terminated' THEN 1 END) * 100.0 / COUNT(*) AS turnover_rate FROM employees.employee_master",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 41,
      "question": "Show me employees who completed training in the last 6 months",
      "category": "medium",
      "pattern_type": "date_filter_join",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", tr.\"CourseName\", tr.\"CompletionDate\", tr.\"Score\" FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE tr.\"Status\" = 'Completed' AND tr.\"CompletionDate\" >= CURRENT_DATE - INTERVAL '6 months' ORDER BY tr.\"CompletionDate\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 42,
      "question": "What is the average time between performance reviews?",
      "category": "tricky",
      "pattern_type": "window_function",
      "tables": ["employees.performance_reviews"],
      "sql": "SELECT \"EmployeeID\", AVG(EXTRACT(EPOCH FROM (\"ReviewDate\" - LAG(\"ReviewDate\") OVER (PARTITION BY \"EmployeeID\" ORDER BY \"ReviewDate\"))) / 86400) AS avg_days_between_reviews FROM employees.performance_reviews GROUP BY \"EmployeeID\" HAVING COUNT(*) > 1",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 43,
      "question": "Show me department with highest engagement scores",
      "category": "medium",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_engagement DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_engagement"
    },
    {
      "id": 44,
      "question": "What is the percentage of employees with advanced skills?",
      "category": "medium",
      "pattern_type": "calculated_percentage",
      "tables": ["employees.employee_master", "employees.skills_inventory"],
      "sql": "SELECT COUNT(DISTINCT CASE WHEN si.\"ProficiencyLevel\" = 'Advanced' OR si.\"ProficiencyLevel\" = 'Expert' THEN em.\"EmployeeID\" END) * 100.0 / COUNT(DISTINCT em.\"EmployeeID\") AS advanced_skill_percentage FROM employees.employee_master em LEFT JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active'",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 45,
      "question": "Show me monthly compensation changes",
      "category": "medium",
      "pattern_type": "time_series_join",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT DATE_TRUNC('month', \"ChangeDate\") AS month, COUNT(*) AS change_count, SUM(\"NewSalary\" - \"OldSalary\") AS total_increase FROM employees.compensation_history GROUP BY DATE_TRUNC('month', \"ChangeDate\") ORDER BY month",
      "visualization": "line",
      "x_axis": "month",
      "y_axis": "change_count"
    },
    {
      "id": 46,
      "question": "What is the average number of skills per employee?",
      "category": "easy",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.employee_master", "employees.skills_inventory"],
      "sql": "SELECT ROUND(AVG(skill_count), 2) AS avg_skills_per_employee FROM (SELECT COUNT(si.\"SkillID\") AS skill_count FROM employees.employee_master em LEFT JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\") AS skill_counts",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 47,
      "question": "Show me employees with no performance reviews",
      "category": "medium",
      "pattern_type": "left_join_null",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT em.\"EmployeeID\", em.\"FullName\", em.\"Department\" FROM employees.employee_master em LEFT JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND pr.\"ReviewID\" IS NULL",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 48,
      "question": "What is the department with most terminations?",
      "category": "medium",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"Department\", SUM(\"Terminations\") AS total_terminations FROM employees.headcount_attrition_summary GROUP BY \"Department\" ORDER BY total_terminations DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "total_terminations"
    },
    {
      "id": 49,
      "question": "Show me employees with salary increases above 10%",
      "category": "medium",
      "pattern_type": "calculated_filter",
      "tables": ["employees.compensation_history", "employees.employee_master"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", ch.\"ChangeDate\", ch.\"OldSalary\", ch.\"NewSalary\", ROUND(((ch.\"NewSalary\" - ch.\"OldSalary\") / NULLIF(ch.\"OldSalary\", 0)) * 100, 2) AS increase_percent FROM employees.compensation_history ch JOIN employees.employee_master em ON ch.\"EmployeeID\" = em.\"EmployeeID\" WHERE ((ch.\"NewSalary\" - ch.\"OldSalary\") / NULLIF(ch.\"OldSalary\", 0)) * 100 > 10 ORDER BY increase_percent DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 50,
      "question": "What is the retention rate by department?",
      "category": "medium",
      "pattern_type": "calculated_metric",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", COUNT(CASE WHEN \"Status\" = 'Active' THEN 1 END) * 100.0 / COUNT(*) AS retention_rate FROM employees.employee_master GROUP BY \"Department\"",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "retention_rate"
    },
    {
      "id": 51,
      "question": "Show me top 3 lowest paid employees",
      "category": "easy",
      "pattern_type": "top_n_ranking",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"Salary\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL ORDER BY \"Salary\" ASC LIMIT 3",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "Salary",
      "parameters": {"n": 3, "order": "ASC", "field": "Salary"}
    },
    {
      "id": 52,
      "question": "What is the average age of employees by department?",
      "category": "tricky",
      "pattern_type": "calculated_metric",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", ROUND(AVG(EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM \"HireDate\")), 2) AS avg_years_since_hire FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"HireDate\" IS NOT NULL GROUP BY \"Department\"",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_years_since_hire"
    },
    {
      "id": 53,
      "question": "Show me employees with engagement scores below 3",
      "category": "medium",
      "pattern_type": "filter_join",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", es.\"OverallSatisfaction\" FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND es.\"OverallSatisfaction\" < 3 ORDER BY es.\"OverallSatisfaction\"",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 54,
      "question": "What is the total training hours completed?",
      "category": "medium",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.training_records"],
      "sql": "SELECT COUNT(*) AS total_training_records FROM employees.training_records WHERE \"Status\" = 'Completed'",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 55,
      "question": "Show me employees with multiple salary changes",
      "category": "medium",
      "pattern_type": "having_clause",
      "tables": ["employees.employee_master", "employees.compensation_history"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(ch.\"ChangeID\") AS change_count FROM employees.employee_master em JOIN employees.compensation_history ch ON em.\"EmployeeID\" = ch.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" HAVING COUNT(ch.\"ChangeID\") > 1 ORDER BY change_count DESC",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "change_count"
    },
    {
      "id": 56,
      "question": "What is the average salary increase amount?",
      "category": "easy",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT ROUND(AVG(\"NewSalary\" - \"OldSalary\"), 2) AS avg_increase FROM employees.compensation_history WHERE \"OldSalary\" IS NOT NULL AND \"NewSalary\" IS NOT NULL",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 57,
      "question": "Show me department headcount comparison",
      "category": "easy",
      "pattern_type": "group_by_category",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", COUNT(*) AS headcount FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Department\" ORDER BY headcount DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "headcount"
    },
    {
      "id": 58,
      "question": "What is the employee distribution by job title?",
      "category": "easy",
      "pattern_type": "distribution",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"JobTitle\", COUNT(*) AS count FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"JobTitle\" ORDER BY count DESC",
      "visualization": "pie",
      "x_axis": "JobTitle",
      "y_axis": "count"
    },
    {
      "id": 59,
      "question": "Show me performance trends over time",
      "category": "tricky",
      "pattern_type": "time_series_join",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT DATE_TRUNC('month', pr.\"ReviewDate\") AS month, ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY DATE_TRUNC('month', pr.\"ReviewDate\") ORDER BY month",
      "visualization": "line",
      "x_axis": "month",
      "y_axis": "avg_performance"
    },
    {
      "id": 60,
      "question": "What is the most common reason for salary changes?",
      "category": "medium",
      "pattern_type": "group_by_category",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT \"Reason\", COUNT(*) AS count FROM employees.compensation_history WHERE \"Reason\" IS NOT NULL GROUP BY \"Reason\" ORDER BY count DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Reason",
      "y_axis": "count"
    },
    {
      "id": 61,
      "question": "Show me employees with highest training scores",
      "category": "medium",
      "pattern_type": "top_n_join",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", AVG(tr.\"Score\") AS avg_score FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE tr.\"Status\" = 'Completed' AND tr.\"Score\" IS NOT NULL GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY avg_score DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "avg_score"
    },
    {
      "id": 62,
      "question": "What is the average number of training courses per employee?",
      "category": "medium",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT ROUND(AVG(course_count), 2) AS avg_courses FROM (SELECT COUNT(tr.\"TrainingID\") AS course_count FROM employees.employee_master em LEFT JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\") AS course_counts",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 63,
      "question": "Show me employees with no skills recorded",
      "category": "medium",
      "pattern_type": "left_join_null",
      "tables": ["employees.employee_master", "employees.skills_inventory"],
      "sql": "SELECT em.\"EmployeeID\", em.\"FullName\", em.\"Department\" FROM employees.employee_master em LEFT JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND si.\"SkillID\" IS NULL",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 64,
      "question": "What is the department with highest average engagement?",
      "category": "medium",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_engagement DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_engagement"
    },
    {
      "id": 65,
      "question": "Show me monthly average engagement scores",
      "category": "medium",
      "pattern_type": "time_series_join",
      "tables": ["employees.engagement_surveys"],
      "sql": "SELECT DATE_TRUNC('month', \"SurveyDate\") AS month, ROUND(AVG(\"OverallSatisfaction\"), 2) AS avg_satisfaction FROM employees.engagement_surveys GROUP BY DATE_TRUNC('month', \"SurveyDate\") ORDER BY month",
      "visualization": "line",
      "x_axis": "month",
      "y_axis": "avg_satisfaction"
    },
    {
      "id": 66,
      "question": "What is the total compensation budget?",
      "category": "easy",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.employee_master"],
      "sql": "SELECT SUM(\"Salary\") AS total_budget FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 67,
      "question": "Show me employees with performance rating above 4",
      "category": "easy",
      "pattern_type": "filter",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"PerformanceRating\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"PerformanceRating\" > 4 ORDER BY \"PerformanceRating\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 68,
      "question": "What is the average tenure in years?",
      "category": "easy",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.employee_master"],
      "sql": "SELECT ROUND(AVG(EXTRACT(EPOCH FROM (CURRENT_DATE - \"HireDate\")) / 365.25), 2) AS avg_tenure_years FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"HireDate\" IS NOT NULL",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 69,
      "question": "Show me top 10 departments by headcount",
      "category": "easy",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", COUNT(*) AS headcount FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Department\" ORDER BY headcount DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "headcount",
      "parameters": {"n": 10, "order": "DESC", "field": "headcount"}
    },
    {
      "id": 70,
      "question": "What is the employee count by gender and department?",
      "category": "medium",
      "pattern_type": "multi_group_by",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", \"Gender\", COUNT(*) AS count FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Department\", \"Gender\" ORDER BY \"Department\", \"Gender\"",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 71,
      "question": "Show me employees with manager information",
      "category": "medium",
      "pattern_type": "self_join",
      "tables": ["employees.employee_master"],
      "sql": "SELECT e.\"EmployeeID\", e.\"FullName\" AS employee_name, e.\"Department\", m.\"FullName\" AS manager_name FROM employees.employee_master e LEFT JOIN employees.employee_master m ON e.\"ManagerID\" = m.\"EmployeeID\" WHERE e.\"Status\" = 'Active'",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 72,
      "question": "What is the average number of direct reports per manager?",
      "category": "tricky",
      "pattern_type": "self_join_aggregation",
      "tables": ["employees.employee_master"],
      "sql": "SELECT m.\"FullName\" AS manager_name, COUNT(e.\"EmployeeID\") AS direct_reports FROM employees.employee_master m LEFT JOIN employees.employee_master e ON m.\"EmployeeID\" = e.\"ManagerID\" WHERE m.\"Status\" = 'Active' GROUP BY m.\"EmployeeID\", m.\"FullName\" HAVING COUNT(e.\"EmployeeID\") > 0 ORDER BY direct_reports DESC",
      "visualization": "bar",
      "x_axis": "manager_name",
      "y_axis": "direct_reports"
    },
    {
      "id": 73,
      "question": "Show me employees with pending training",
      "category": "medium",
      "pattern_type": "filter_join",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", tr.\"CourseName\", tr.\"Status\" FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE tr.\"Status\" = 'In Progress' OR tr.\"Status\" = 'Not Started'",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 74,
      "question": "What is the completion rate for each training course?",
      "category": "medium",
      "pattern_type": "calculated_percentage",
      "tables": ["employees.training_records"],
      "sql": "SELECT \"CourseName\", COUNT(CASE WHEN \"Status\" = 'Completed' THEN 1 END) * 100.0 / COUNT(*) AS completion_rate FROM employees.training_records GROUP BY \"CourseName\" ORDER BY completion_rate DESC",
      "visualization": "bar",
      "x_axis": "CourseName",
      "y_axis": "completion_rate"
    },
    {
      "id": 75,
      "question": "Show me employees with low engagement scores",
      "category": "medium",
      "pattern_type": "filter_join",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", AVG(es.\"OverallSatisfaction\") AS avg_satisfaction FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" HAVING AVG(es.\"OverallSatisfaction\") < 3 ORDER BY avg_satisfaction",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 76,
      "question": "What is the salary range by department?",
      "category": "medium",
      "pattern_type": "range_aggregation",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", MIN(\"Salary\") AS min_salary, MAX(\"Salary\") AS max_salary, ROUND(AVG(\"Salary\"), 2) AS avg_salary FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL GROUP BY \"Department\" ORDER BY avg_salary DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 77,
      "question": "Show me employees with highest number of completed trainings",
      "category": "medium",
      "pattern_type": "top_n_join",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(tr.\"TrainingID\") AS training_count FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE tr.\"Status\" = 'Completed' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY training_count DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "training_count"
    },
    {
      "id": 78,
      "question": "What is the average performance score improvement over time?",
      "category": "tricky",
      "pattern_type": "window_function",
      "tables": ["employees.performance_reviews"],
      "sql": "SELECT \"EmployeeID\", AVG(\"OverallScore\" - LAG(\"OverallScore\") OVER (PARTITION BY \"EmployeeID\" ORDER BY \"ReviewDate\")) AS avg_improvement FROM employees.performance_reviews GROUP BY \"EmployeeID\" HAVING COUNT(*) > 1",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 79,
      "question": "Show me departments with increasing headcount",
      "category": "tricky",
      "pattern_type": "trend_analysis",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"Department\", \"MonthEnd\", SUM(\"Headcount\") AS headcount FROM employees.headcount_attrition_summary GROUP BY \"Department\", \"MonthEnd\" ORDER BY \"Department\", \"MonthEnd\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "headcount"
    },
    {
      "id": 80,
      "question": "What is the correlation between salary and performance?",
      "category": "tricky",
      "pattern_type": "correlation_analysis",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(em.\"Salary\"), 2) AS avg_salary, ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND em.\"Salary\" IS NOT NULL GROUP BY em.\"Department\"",
      "visualization": "scatter",
      "x_axis": "avg_salary",
      "y_axis": "avg_performance"
    },
    {
      "id": 81,
      "question": "Show me employees with no engagement surveys",
      "category": "medium",
      "pattern_type": "left_join_null",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"EmployeeID\", em.\"FullName\", em.\"Department\" FROM employees.employee_master em LEFT JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND es.\"SurveyResponseID\" IS NULL",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 82,
      "question": "What is the average training score by department?",
      "category": "medium",
      "pattern_type": "aggregation_join",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"Department\", ROUND(AVG(tr.\"Score\"), 2) AS avg_training_score FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE tr.\"Status\" = 'Completed' AND tr.\"Score\" IS NOT NULL GROUP BY em.\"Department\" ORDER BY avg_training_score DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "avg_training_score"
    },
    {
      "id": 83,
      "question": "Show me monthly compensation budget changes",
      "category": "medium",
      "pattern_type": "time_series_calculated",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT DATE_TRUNC('month', \"ChangeDate\") AS month, SUM(\"NewSalary\" - \"OldSalary\") AS budget_change FROM employees.compensation_history GROUP BY DATE_TRUNC('month', \"ChangeDate\") ORDER BY month",
      "visualization": "line",
      "x_axis": "month",
      "y_axis": "budget_change"
    },
    {
      "id": 84,
      "question": "What is the employee count by status and department?",
      "category": "medium",
      "pattern_type": "multi_group_by",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", \"Status\", COUNT(*) AS count FROM employees.employee_master GROUP BY \"Department\", \"Status\" ORDER BY \"Department\", \"Status\"",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 85,
      "question": "Show me top 5 skills in demand",
      "category": "easy",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.skills_inventory"],
      "sql": "SELECT \"SkillName\", COUNT(*) AS demand_count FROM employees.skills_inventory GROUP BY \"SkillName\" ORDER BY demand_count DESC LIMIT 5",
      "visualization": "bar",
      "x_axis": "SkillName",
      "y_axis": "demand_count",
      "parameters": {"n": 5, "order": "DESC", "field": "demand_count"}
    },
    {
      "id": 86,
      "question": "What is the average time to complete training?",
      "category": "tricky",
      "pattern_type": "calculated_metric",
      "tables": ["employees.training_records"],
      "sql": "SELECT \"CourseName\", AVG(EXTRACT(EPOCH FROM (\"CompletionDate\" - \"TrainingID\"::timestamp)) / 86400) AS avg_days FROM employees.training_records WHERE \"Status\" = 'Completed' AND \"CompletionDate\" IS NOT NULL GROUP BY \"CourseName\"",
      "visualization": "bar",
      "x_axis": "CourseName",
      "y_axis": "avg_days"
    },
    {
      "id": 87,
      "question": "Show me employees with declining performance",
      "category": "tricky",
      "pattern_type": "window_function",
      "tables": ["employees.performance_reviews"],
      "sql": "SELECT \"EmployeeID\", \"ReviewDate\", \"OverallScore\", LAG(\"OverallScore\") OVER (PARTITION BY \"EmployeeID\" ORDER BY \"ReviewDate\") AS previous_score FROM employees.performance_reviews WHERE \"OverallScore\" < LAG(\"OverallScore\") OVER (PARTITION BY \"EmployeeID\" ORDER BY \"ReviewDate\")",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 88,
      "question": "What is the department with highest average training completion?",
      "category": "medium",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.employee_master", "employees.training_records"],
      "sql": "SELECT em.\"Department\", COUNT(CASE WHEN tr.\"Status\" = 'Completed' THEN 1 END) * 100.0 / COUNT(tr.\"TrainingID\") AS completion_rate FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY completion_rate DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "completion_rate"
    },
    {
      "id": 89,
      "question": "Show me employees with all three engagement metrics above average",
      "category": "tricky",
      "pattern_type": "complex_filter",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", AVG(es.\"OverallSatisfaction\") AS avg_satisfaction, AVG(es.\"WorkLifeBalanceScore\") AS avg_worklife, AVG(es.\"ManagerFeedbackScore\") AS avg_manager FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" HAVING AVG(es.\"OverallSatisfaction\") > (SELECT AVG(\"OverallSatisfaction\") FROM employees.engagement_surveys) AND AVG(es.\"WorkLifeBalanceScore\") > (SELECT AVG(\"WorkLifeBalanceScore\") FROM employees.engagement_surveys) AND AVG(es.\"ManagerFeedbackScore\") > (SELECT AVG(\"ManagerFeedbackScore\") FROM employees.engagement_surveys)",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 90,
      "question": "What is the total number of active employees by department?",
      "category": "easy",
      "pattern_type": "group_by_category",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", COUNT(*) AS active_count FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Department\" ORDER BY active_count DESC",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "active_count"
    },
    {
      "id": 91,
      "question": "Show me employees with salary in top 10 percentile",
      "category": "tricky",
      "pattern_type": "percentile_filter",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"EmployeeID\", \"FullName\", \"Department\", \"Salary\" FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" >= (SELECT PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY \"Salary\") FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL) ORDER BY \"Salary\" DESC",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 92,
      "question": "What is the average engagement score by job title?",
      "category": "medium",
      "pattern_type": "aggregation_join",
      "tables": ["employees.employee_master", "employees.engagement_surveys"],
      "sql": "SELECT em.\"JobTitle\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"JobTitle\" ORDER BY avg_engagement DESC",
      "visualization": "bar",
      "x_axis": "JobTitle",
      "y_axis": "avg_engagement"
    },
    {
      "id": 93,
      "question": "Show me employees with performance improvement",
      "category": "tricky",
      "pattern_type": "window_function",
      "tables": ["employees.performance_reviews"],
      "sql": "SELECT \"EmployeeID\", \"ReviewDate\", \"OverallScore\", \"OverallScore\" - LAG(\"OverallScore\") OVER (PARTITION BY \"EmployeeID\" ORDER BY \"ReviewDate\") AS improvement FROM employees.performance_reviews WHERE \"OverallScore\" > LAG(\"OverallScore\") OVER (PARTITION BY \"EmployeeID\" ORDER BY \"ReviewDate\")",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 94,
      "question": "What is the department with most skills diversity?",
      "category": "medium",
      "pattern_type": "top_n_aggregation",
      "tables": ["employees.employee_master", "employees.skills_inventory"],
      "sql": "SELECT em.\"Department\", COUNT(DISTINCT si.\"SkillName\") AS unique_skills FROM employees.employee_master em JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY unique_skills DESC LIMIT 1",
      "visualization": "bar",
      "x_axis": "Department",
      "y_axis": "unique_skills"
    },
    {
      "id": 95,
      "question": "Show me monthly average headcount by department",
      "category": "medium",
      "pattern_type": "time_series_grouped",
      "tables": ["employees.headcount_attrition_summary"],
      "sql": "SELECT \"MonthEnd\", \"Department\", AVG(\"Headcount\") AS avg_headcount FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\", \"Department\" ORDER BY \"MonthEnd\", \"Department\"",
      "visualization": "line",
      "x_axis": "MonthEnd",
      "y_axis": "avg_headcount"
    },
    {
      "id": 96,
      "question": "What is the average salary by gender and department?",
      "category": "medium",
      "pattern_type": "multi_group_by",
      "tables": ["employees.employee_master"],
      "sql": "SELECT \"Department\", \"Gender\", ROUND(AVG(\"Salary\"), 2) AS avg_salary FROM employees.employee_master WHERE \"Status\" = 'Active' AND \"Salary\" IS NOT NULL GROUP BY \"Department\", \"Gender\" ORDER BY \"Department\", \"Gender\"",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 97,
      "question": "Show me employees with manager and their performance",
      "category": "medium",
      "pattern_type": "self_join_with_other",
      "tables": ["employees.employee_master", "employees.performance_reviews"],
      "sql": "SELECT e.\"FullName\" AS employee, e.\"Department\", m.\"FullName\" AS manager, pr.\"OverallScore\" FROM employees.employee_master e LEFT JOIN employees.employee_master m ON e.\"ManagerID\" = m.\"EmployeeID\" LEFT JOIN employees.performance_reviews pr ON e.\"EmployeeID\" = pr.\"EmployeeID\" WHERE e.\"Status\" = 'Active'",
      "visualization": "table",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 98,
      "question": "What is the total number of compensation changes this year?",
      "category": "easy",
      "pattern_type": "date_filtered_count",
      "tables": ["employees.compensation_history"],
      "sql": "SELECT COUNT(*) AS total_changes FROM employees.compensation_history WHERE EXTRACT(YEAR FROM \"ChangeDate\") = EXTRACT(YEAR FROM CURRENT_DATE)",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    },
    {
      "id": 99,
      "question": "Show me employees with highest engagement and performance scores",
      "category": "tricky",
      "pattern_type": "multi_join_top_n",
      "tables": ["employees.employee_master", "employees.engagement_surveys", "employees.performance_reviews"],
      "sql": "SELECT em.\"FullName\", em.\"Department\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement, ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY (AVG(es.\"OverallSatisfaction\") + AVG(pr.\"OverallScore\")) / 2 DESC LIMIT 10",
      "visualization": "bar",
      "x_axis": "FullName",
      "y_axis": "avg_engagement"
    },
    {
      "id": 100,
      "question": "What is the overall employee satisfaction score?",
      "category": "easy",
      "pattern_type": "single_value_aggregation",
      "tables": ["employees.engagement_surveys"],
      "sql": "SELECT ROUND(AVG(\"OverallSatisfaction\"), 2) AS overall_satisfaction FROM employees.engagement_surveys WHERE \"OverallSatisfaction\" IS NOT NULL",
      "visualization": "none",
      "x_axis": null,
      "y_axis": null
    }
  ]
}

