[
  {
    "id": 2,
    "question": "What is the gender distribution of employees?",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT \"Gender\", COUNT(*) AS count FROM employees.employee_master WHERE \"Status\" = 'Active' GROUP BY \"Gender\"",
    "actual_sql": "",
    "expected_viz": "pie",
    "actual_viz": "bar",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 3,
    "question": "Show me headcount trends over time by month",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT \"MonthEnd\", SUM(\"Headcount\") AS Total_Headcount FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
    "actual_sql": "",
    "expected_viz": "area",
    "actual_viz": "line",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 7,
    "question": "Show me monthly attrition rate trends",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT \"MonthEnd\", AVG(\"AttritionRate\") AS avg_attrition_rate FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
    "actual_sql": "",
    "expected_viz": "area",
    "actual_viz": "line",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 13,
    "question": "Show me employees with highest engagement scores",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", AVG(es.\"OverallSatisfaction\") AS avg_satisfaction FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY avg_satisfaction DESC LIMIT 10",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "bar",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 14,
    "question": "What is the average work-life balance score by department?",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"Department\", ROUND(AVG(es.\"WorkLifeBalanceScore\"), 2) AS avg_worklife_score FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_worklife_score DESC",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "bar",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 17,
    "question": "Show me employees with their performance review scores",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", pr.\"ReviewDate\", pr.\"OverallScore\", pr.\"Communication\", pr.\"Teamwork\", pr.\"ProblemSolving\" FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' ORDER BY pr.\"ReviewDate\" DESC",
    "actual_sql": "",
    "expected_viz": "table",
    "actual_viz": "table",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 18,
    "question": "What is the average performance score by department?",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"Department\", ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_performance DESC",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "bar",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 19,
    "question": "Show me employees with most skills",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(si.\"SkillID\") AS skill_count FROM employees.employee_master em LEFT JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" ORDER BY skill_count DESC LIMIT 10",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "table",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 21,
    "question": "Show me training completion rates by department",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"Department\", COUNT(CASE WHEN tr.\"Status\" = 'Completed' THEN 1 END) * 100.0 / COUNT(tr.\"TrainingID\") AS completion_rate FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\"",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "bar",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 27,
    "question": "Show me monthly termination trends",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT \"MonthEnd\", SUM(\"Terminations\") AS total_terminations FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\" ORDER BY \"MonthEnd\"",
    "actual_sql": "",
    "expected_viz": "line",
    "actual_viz": "line",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 31,
    "question": "Show me department headcount over time",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT \"MonthEnd\", \"Department\", SUM(\"Headcount\") AS headcount FROM employees.headcount_attrition_summary GROUP BY \"MonthEnd\", \"Department\" ORDER BY \"MonthEnd\", \"Department\"",
    "actual_sql": "",
    "expected_viz": "line",
    "actual_viz": "bar",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 32,
    "question": "What is the employee count by status?",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT \"Status\", COUNT(*) AS count FROM employees.employee_master GROUP BY \"Status\"",
    "actual_sql": "",
    "expected_viz": "pie",
    "actual_viz": "none",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 33,
    "question": "Show me employees with their latest performance review",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT DISTINCT ON (em.\"EmployeeID\") em.\"FullName\", em.\"Department\", pr.\"ReviewDate\", pr.\"OverallScore\" FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' ORDER BY em.\"EmployeeID\", pr.\"ReviewDate\" DESC",
    "actual_sql": "",
    "expected_viz": "table",
    "actual_viz": "table",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 35,
    "question": "Show me skill proficiency distribution",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT \"ProficiencyLevel\", COUNT(*) AS count FROM employees.skills_inventory GROUP BY \"ProficiencyLevel\"",
    "actual_sql": "",
    "expected_viz": "pie",
    "actual_viz": "bar",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 37,
    "question": "Show me employees with multiple performance reviews",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(pr.\"ReviewID\") AS review_count FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" HAVING COUNT(pr.\"ReviewID\") > 1 ORDER BY review_count DESC",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "table",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 38,
    "question": "What is the correlation between engagement and performance?",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"Department\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement, ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\"",
    "actual_sql": "",
    "expected_viz": "scatter",
    "actual_viz": "scatter",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 41,
    "question": "Show me employees who completed training in the last 6 months",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", tr.\"CourseName\", tr.\"CompletionDate\", tr.\"Score\" FROM employees.employee_master em JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE tr.\"Status\" = 'Completed' AND tr.\"CompletionDate\" >= CURRENT_DATE - INTERVAL '6 months' ORDER BY tr.\"CompletionDate\" DESC",
    "actual_sql": "",
    "expected_viz": "table",
    "actual_viz": "table",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 43,
    "question": "Show me department with highest engagement scores",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"Department\", ROUND(AVG(es.\"OverallSatisfaction\"), 2) AS avg_engagement FROM employees.employee_master em JOIN employees.engagement_surveys es ON em.\"EmployeeID\" = es.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"Department\" ORDER BY avg_engagement DESC LIMIT 1",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "bar",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 44,
    "question": "What is the percentage of employees with advanced skills?",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT COUNT(DISTINCT CASE WHEN si.\"ProficiencyLevel\" = 'Advanced' OR si.\"ProficiencyLevel\" = 'Expert' THEN em.\"EmployeeID\" END) * 100.0 / COUNT(DISTINCT em.\"EmployeeID\") AS advanced_skill_percentage FROM employees.employee_master em LEFT JOIN employees.skills_inventory si ON em.\"EmployeeID\" = si.\"EmployeeID\" WHERE em.\"Status\" = 'Active'",
    "actual_sql": "",
    "expected_viz": "none",
    "actual_viz": "none",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 45,
    "question": "Show me monthly compensation changes",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT DATE_TRUNC('month', \"ChangeDate\") AS month, COUNT(*) AS change_count, SUM(\"NewSalary\" - \"OldSalary\") AS total_increase FROM employees.compensation_history GROUP BY DATE_TRUNC('month', \"ChangeDate\") ORDER BY month",
    "actual_sql": "",
    "expected_viz": "line",
    "actual_viz": "line",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 47,
    "question": "Show me employees with no performance reviews",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"EmployeeID\", em.\"FullName\", em.\"Department\" FROM employees.employee_master em LEFT JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND pr.\"ReviewID\" IS NULL",
    "actual_sql": "",
    "expected_viz": "table",
    "actual_viz": "table",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 49,
    "question": "Show me employees with salary increases above 10%",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", ch.\"ChangeDate\", ch.\"OldSalary\", ch.\"NewSalary\", ROUND(((ch.\"NewSalary\" - ch.\"OldSalary\") / NULLIF(ch.\"OldSalary\", 0)) * 100, 2) AS increase_percent FROM employees.compensation_history ch JOIN employees.employee_master em ON ch.\"EmployeeID\" = em.\"EmployeeID\" WHERE ((ch.\"NewSalary\" - ch.\"OldSalary\") / NULLIF(ch.\"OldSalary\", 0)) * 100 > 10 ORDER BY increase_percent DESC",
    "actual_sql": "",
    "expected_viz": "table",
    "actual_viz": "table",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 55,
    "question": "Show me employees with multiple salary changes",
    "sql_match": false,
    "viz_match": false,
    "expected_sql": "SELECT em.\"FullName\", em.\"Department\", COUNT(ch.\"ChangeID\") AS change_count FROM employees.employee_master em JOIN employees.compensation_history ch ON em.\"EmployeeID\" = ch.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\", em.\"FullName\", em.\"Department\" HAVING COUNT(ch.\"ChangeID\") > 1 ORDER BY change_count DESC",
    "actual_sql": "",
    "expected_viz": "bar",
    "actual_viz": "table",
    "cache_hit": true,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 62,
    "question": "What is the average number of training courses per employee?",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT ROUND(AVG(course_count), 2) AS avg_courses FROM (SELECT COUNT(tr.\"TrainingID\") AS course_count FROM employees.employee_master em LEFT JOIN employees.training_records tr ON em.\"EmployeeID\" = tr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' GROUP BY em.\"EmployeeID\") AS course_counts",
    "actual_sql": "",
    "expected_viz": "none",
    "actual_viz": "none",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  },
  {
    "id": 80,
    "question": "What is the correlation between salary and performance?",
    "sql_match": false,
    "viz_match": true,
    "expected_sql": "SELECT em.\"Department\", ROUND(AVG(em.\"Salary\"), 2) AS avg_salary, ROUND(AVG(pr.\"OverallScore\"), 2) AS avg_performance FROM employees.employee_master em JOIN employees.performance_reviews pr ON em.\"EmployeeID\" = pr.\"EmployeeID\" WHERE em.\"Status\" = 'Active' AND em.\"Salary\" IS NOT NULL GROUP BY em.\"Department\"",
    "actual_sql": "",
    "expected_viz": "scatter",
    "actual_viz": "scatter",
    "cache_hit": false,
    "pattern_matched": false,
    "tokens": 0
  }
]